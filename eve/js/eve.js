window.AudioContext=window.AudioContext||window.webkitAudioContext;var EVE={synth:new AudioContext,config:{harmonics:8,master_freq:440,octave_shift:0},program:{name:"INITIALIZE",osc1:1,osc2:0,osc3:0,osc4:0,osc5:0,osc6:0,osc7:0,osc8:0,vca_a:.1,vca_d:.4,vca_s:.65,vca_r:.4,vca_g:0},buildButton:document.getElementById("build-button"),registerButton:document.getElementById("register-button"),now:function(){"use strict";return EVE.synth.currentTime},attack:function(t){"use strict";return EVE.synth.currentTime+t},decay:function(){"use strict"},sustain:function(){"use strict"},release:function(){"use strict"}};EVE.events={press:new CustomEvent("press",{bubbles:!0}),navigate:new CustomEvent("navigate",{detail:{place:window.location},bubbles:!0})},EVE.buildSynth=function(){"use strict";function t(t){var e,n,a,o;for(e=0;t>e;e+=1)n=e+1,a="osc"+n,o=a+"_vca",EVE[o]=EVE.synth.createGain(),EVE[o].gain.setValueAtTime(1,EVE.now()),EVE[o].connect(EVE.vca),EVE[a]=EVE.synth.createOscillator(),EVE[a].type="sine",EVE[a].frequency.value=EVE.config.master_freq*n,EVE[a].connect(EVE[o]),EVE.harmonicOscs.push(EVE[a]),EVE.harmonicVcas.push(EVE[o])}return EVE.harmonicOscs=[],EVE.harmonicVcas=[],EVE.vca=EVE.synth.createGain(),EVE.vca.gain.setValueAtTime(0,EVE.now()),EVE.vca.connect(EVE.synth.destination),t(EVE.config.harmonics),EVE.buildSynth=function(){return console.warn("Synth already built"),!0},!0},EVE.startSynth=function(){"use strict";var t;for(console.log("Start synth called"),t=0;t<EVE.config.harmonics;t+=1)EVE.harmonicOscs[t].start(0);return EVE.startSynth=function(){return console.warn("startSynth already called"),!0},!0},EVE.gateOn=function(t){"use strict";t.target.dataset.noteValue&&(console.log(t.target.dataset.noteValue),EVE.vca.gain.linearRampToValueAtTime(1,EVE.attack(EVE.program.vca_a)),t.target.dispatchEvent(EVE.events.press))},EVE.gateOff=function(t){"use strict";t.target.dataset.noteValue&&(console.log("gateOff",t.target.dataset.noteValue),EVE.vca.gain.setTargetAtTime(0,EVE.now(),.1))},EVE.calculatePitch=function(){"use strict";console.log("calculatePitch called")},function(){"use strict";EVE.buildSynth(),EVE.startSynth(),EVE.keyboard=document.getElementById("keyboard"),EVE.keyboard.addEventListener("mousedown",EVE.gateOn),EVE.keyboard.addEventListener("mouseup",EVE.gateOff),EVE.keyboard.addEventListener("press",function(t){console.log("Set note via custom event to",t.target.dataset.noteValue)})}(),EVE.testBuild=function(){"use strict";var t={page:"build"};history.pushState(t,"","build"),window.dispatchEvent(EVE.events.navigate),console.log("Test build called",history.state.page)},EVE.testRegister=function(){"use strict";var t={page:"register"};history.pushState(t,"","register"),window.dispatchEvent(EVE.events.navigate),console.log("Test register called",history.state.page)},EVE.historyChange=function(){"use strict";console.log("History pop state going on")},EVE.router=function(t){"use strict";switch(console.log("Router activated",history.state.page),history.state.page){case"build":console.log("Go to build page");break;case"register":console.log("Go to registration page"),console.dir(t);break;default:console.log("404 page, man.")}},EVE.buildButton.addEventListener("click",EVE.testBuild),EVE.registerButton.addEventListener("click",EVE.testRegister),window.addEventListener("popstate",EVE.historyChange),window.addEventListener("navigate",EVE.router);